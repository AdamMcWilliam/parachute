var e;e="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var a=0,c=e.length,n=-1,i=!1;a<c&&!i;)e[a]===t&&(n=a,i=!0),a++;return n};var t=function(){this.events={}};t.prototype.on=function(e,t){"object"!=typeof this.events[e]&&(this.events[e]=[]),this.events[e].push(t)},t.prototype.removeListener=function(t,a){var c;"object"==typeof this.events[t]&&(c=e(this.events[t],a))>-1&&this.events[t].splice(c,1)},t.prototype.emit=function(e){var t,a,c,n=[].slice.call(arguments,1);if("object"==typeof this.events[e])for(c=(a=this.events[e].slice()).length,t=0;t<c;t++)a[t].apply(this,n)},t.prototype.once=function(e,t){this.on(e,(function a(){this.removeListener(e,a),t.apply(this,arguments)}))};let a=new class extends t{constructor(){super()}keydown(e){this.emit("keydown",e)}keyup(e){this.emit("keyup",e)}update(e){this.emit("update",e)}};var c={};window.addEventListener("keydown",e=>{a.emit("keydown",e.key),c[e.key]=1}),window.addEventListener("keyup",e=>{a.emit("keyup",e.key),delete c[e.key]}),requestAnimationFrame((function e(){a.emit("update",c),requestAnimationFrame(e)}));function n(e){return Math.floor(Math.random()*Math.floor(e))}window.WebFontConfig={custom:{families:["Pixeltype"]},active(){Unicorn.Create("unicorn-display",{width:1280,height:720,background:"transparent",init:r,update:o,screenWalls:!1,wallLeft:!0,wallRight:!0,gravity:{x:0,y:0}}),ComfyJS.onConnected=async(e,t,a)=>{}}},function(){const e=document.createElement("script");e.src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",e.type="text/javascript",e.async="true";const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}();let i={path:"https://www.pixelplush.dev",bg:"game-parachute/bcg",target:"game-parachute/target",clouds:["game-parachute/cloud1","game-parachute/cloud2","game-parachute/cloud3","game-parachute/cloud4","game-parachute/cloud5"],parachutes:["game-parachute/chute_black_blue","game-parachute/chute_black_purple","game-parachute/chute_black_red","game-parachute/chute_black_white","game-parachute/chute_black_yellow","game-parachute/chute_blue_green","game-parachute/chute_blue_purple","game-parachute/chute_blue_yellow","game-parachute/chute_blue","game-parachute/chute_green","game-parachute/chute_pink_blue","game-parachute/chute_pink_purple","game-parachute/chute_pink","game-parachute/chute_purple_blue","game-parachute/chute_purple","game-parachute/chute_red_purple","game-parachute/chute_retro","game-parachute/chute_white_blue","game-parachute/chute_white_green","game-parachute/chute_white_pink","game-parachute/chute_white_purple","game-parachute/chute_white_red","game-parachute/chute_white_turquoise","game-parachute/chute_white_yellow","game-parachute/chute_yellow"]};function r(){PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST,Unicorn.Load("map",`${i.path}/assets/${i.bg}.png`);var e=Unicorn.AddBacklay("map","map",0,-360);e.scale.x=3,e.scale.y=4.5,i.clouds.forEach(e=>Unicorn.Load(e,`${i.path}/assets/${e}.png`)),Unicorn.AddObject("WallLeft",{type:"rectangle",x:-200,y:0,width:400,height:1440,isStatic:!0}).sprite.visible=!1,Unicorn.AddObject("WallRight",{type:"rectangle",x:1480,y:0,width:400,height:1440,isStatic:!0}).sprite.visible=!1,Unicorn.AddObject("WallBottom",{type:"rectangle",x:640,y:820,width:1280,height:200,isStatic:!0}).sprite.visible=!1,async function(){for(let e=0;e<11;e++){h++;let e,t=i.clouds[n(i.clouds.length)];e=Math.random()>.5?Unicorn.AddOverlay("cloud_"+h,t,n(1280),n(500),{scale:{x:1,y:1}}):Unicorn.AddBacklay("cloud_"+h,t,n(1280),n(500),{scale:{x:1,y:1}}),e.alpha=.9,e.anchor.set(.5),e.speed=.01+.1*Math.random(),e.zIndex=e.speed,s.push(e)}let e=await async function(e){let t={};try{let a=await fetch("https://api.pixelplush.dev/v1/accounts/twitch/design?username="+e).then(e=>e.json());a&&(t=a.style||{})}catch(e){console.error(e)}return t}("instafluff");console.log(e);let t=e.character.path;Unicorn.Load(e.character.id+"_0",`${i.path}/assets/characters/${e.character.id}/${t}_front/${t}_front1.png`),p=Unicorn.AddObject("player",{type:"circle",scale:{x:3,y:3},sprite:e.character.id+"_0",x:640,y:240,z:100,radius:36}),console.log(p),p.sprite.zIndex=10;for(let e=0;e<5;e++){let t=n(1280),a=720+720*(e+1)/2,c=Math.max(Math.max(200,600-10*y),n(1280-10*y));h++;let i=Unicorn.AddObject("obstacle_"+h,{type:"rectangle",scale:{x:3,y:3},x:(t-c/2)/2,y:a,width:(t-c/2)/3,height:20,isStatic:!0});console.log(i),i.sprite.zIndex=50,l.push(i),h++,i=Unicorn.AddObject("obstacle_"+h,{type:"rectangle",scale:{x:3,y:3},x:t+c/2+(1280-t+c/2)/2,y:a,width:(1280-t+c/2)/3,height:20,isStatic:!0}),console.log(i),i.sprite.zIndex=50,l.push(i)}g=!0}()}function o(e,t){s.forEach((e,a)=>{e.y-=t*e.speed,e.y+e.height/2<=0&&(e.y=720+e.height/2,e.x=e.width/2+n(1280),e.speed=.01+.1*Math.random(),e.zIndex=e.speed)});let a=!1;if(l.forEach((e,c)=>{e.position.y-=.1*t,e.position.y+20<=0&&(a=!0,Unicorn.RemoveObject(e.label),y++)}),a){l.shift(),l.shift();let e=n(1280),t=720+l.length/2*720/2,a=Math.max(Math.max(100,600-10*y),n(1280-10*y));h++;let c=Unicorn.AddObject("obstacle_"+h,{type:"rectangle",scale:{x:3,y:3},x:(e-a/2)/2,y:t,width:(e-a/2)/3,height:20,isStatic:!0});console.log(c),c.sprite.zIndex=50,l.push(c),h++,c=Unicorn.AddObject("obstacle_"+h,{type:"rectangle",scale:{x:3,y:3},x:e+a/2+(1280-e+a/2)/2,y:t,width:(1280-e+a/2)/3,height:20,isStatic:!0}),console.log(c),c.sprite.zIndex=50,l.push(c)}if(g){u&&Matter.Body.setVelocity(p,{x:p.velocity.x-t/100,y:p.velocity.y}),d&&Matter.Body.setVelocity(p,{x:p.velocity.x+t/100,y:p.velocity.y}),p.position.y=240+10*Math.sin(e/500);let a=Math.max(-Math.PI,Math.min(Math.PI,p.velocity.x/10));p.angle=.5*p.angle+.5*a}}let h=0,s=[],l=[],p=null,u=!1,d=!1,y=0,g=!1;a.on("keydown",e=>{switch(e){case"ArrowLeft":case"a":u=!0;break;case"ArrowRight":case"d":d=!0}}),a.on("keyup",e=>{switch(e){case"ArrowLeft":case"a":u=!1;break;case"ArrowRight":case"d":d=!1}});